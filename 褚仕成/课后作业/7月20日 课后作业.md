### 信号量（semaphore）：

- 信号量值非负，value数值表示当前可用资源数，不传输数据内容，常用来同步。

- 二值信号量取值范围（0-1），多值信号量取值范围（0-65535）；

- 获取信号量有超时阻塞机制（take函数有阻塞，try_take函数无阻塞，release函数无阻塞）；

- 线程和中断都可以释放信号量，信号量无所有权，任何线程或中断都可以释放。

- 获取信号量则value-1，释放信号量value+1；

- FIFO、PRIO两种阻塞唤醒方式（线程等待信号量资源而阻塞）；

- 一般不用信号量做互斥，易出现优先级翻转问题（低优先级获取资源运行，高优先级等待资源阻塞）。

  

### 互斥量（mutex）：

- 初始化时，value=1，表示互斥量处于开锁状态，可被持有。常用来保护临界资源。
- 互斥量只能在线程中使用，不可在中断中使用；
- 获取互斥量有超时阻塞机制（take函数有阻塞，release函数无阻塞）；
- 互斥量有所有权，其只能被持有线程释放，该线程具有此互斥量的所有权，其余线程不能同时持有该互斥量；
- 已持有互斥量的线程，再次获取该互斥量时，不会挂起（递归访问），但持有量计数加1；
- 保证每个时刻只有一个线程正在访问该互斥量保护的临界资源（闭锁）；其他任何优先级的线程想访问该资源时都会阻塞；
- FIFO、PRIO两种阻塞唤醒方式（线程等待互斥量资源而阻塞）；
- 优先级继承：暂时提高持有互斥量线程的优先级，执行完毕后，释放互斥量时，恢复原有优先级。该方法不会彻底解决优先级翻转问题，只是缓解影响。
  

## 邮箱（mailbox）：

- 一封邮件仅可传输4字节数据内容（规定），在32位系统中，4字节相当于一个指针的大小；因此，在需要传输较多数据时，可通过创建结构体，使用指针指向地址的方式传输；
- 发送和接收邮件都支持超时阻塞机制（send函数无阻塞，send_wait函数有阻塞，recv函数有阻塞）；
- 线程、中断都可发送邮件，但注意，中断服务函数不允许任何阻塞，所以中断发送邮件必须选择非阻塞方式；
- 中断服务函数中不能接收邮件，因为中断不可阻塞；
- 一个线程可从任何一个邮箱接收和发送邮件；
- 多个线程可以向同一个邮箱发送和接收邮件；
- FIFO、PRIO两种阻塞唤醒方式（线程等待邮件资源而阻塞）；
- 邮箱中有entery表示邮箱可用邮件数，in_offset，out_offset指针指向邮件存放地址偏移量（自加1偏移4个字节），初始化为0，线程发送一个邮件到邮箱，entery +1,in_offset+1，若邮箱满了则in_offset清0；线程从邮箱接收一个邮件，entery-1,out_offset+1，若邮箱空了则out_offset清0；
- 若邮箱中有邮件，接收线程接收时，其实是复制邮箱中4字节的内容到接收地址中；
  

## 消息队列（messagequeue）：

- 消息队列是邮箱的扩展，其可接收线程和中断发送的不固定长度的消息；
- 读消息队列（接收）支持超时阻塞机制（send函数无阻塞，recv函数有阻塞）；
- 线程、中断都可以发送消息给消息队列；
- 中断服务函数中不能接收消息，因为中断不可阻塞；
- 一个线程可从任何一个消息队列接收和发送邮件；
- 多个线程可以向同一个消息队列发送和接收邮件；
- FIFO、PRIO两种阻塞唤醒方式（线程等待邮件资源而阻塞）；
- 支持发送紧急消息，将消息放在队列的头部（正常是放尾部）。
- 当空闲消息链表上有空闲消息块时，线程或中断将消息复制到该消息块上，然后将该消息块挂在消息队列的尾部。若无空闲消息块，要发送消息的线程和中断会受到错误码；
- 消息队列中有entry表示队列中可用消息个数，msg_queue_head链表头指针指向即将读取数据的节点，线程读取走一个消息，entry-1，msg_queue_head指向下一个消息，如果继续读取消息直到尾部，则msg_queue_tail指向NULL；msg_queue_tail链表尾指针指向写入的数据节点，线程发送一个消息，entry+1，msg_queue_tail指向当前新写入的消息；
  

## 事件集（event）：

- set值只表示事件状态（0：未发生，1：已发生），不传输具体数据内容；

- 事件集用32位无符号整型变量set，每一位表示一个事件，共32个事件。

- 获取事件有超时阻塞机制（send函数无阻塞，recv函数有阻塞）；

- 中断可发送事件；

- 一个线程可等待多个事件（逻辑与：全部发生才有效，逻辑或：有一个发生即有效）；

- 多个线程等待多个事件（逻辑与：全部发生才有效，逻辑或：有一个发生即有效）；

- 事件无排队性，多次向线程发送同一事件，若线程未来得及读走该事件，其效果等同于只发一次；

- FIFO、PRIO两种阻塞唤醒方式（线程等待事件资源而阻塞）；

- 事件集与信号量的对比：
  事件集：发送操作不可计数；
  信号量：释放操作可计数；

  事件集：接收（recv）线程可等待多种事件；
  信号量：获取（take）线程不能同时等待多种类型的释放，只能识别单一的释放动作；